{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Documents\\\\lostnfound_fullstack\\\\frontend\\\\src\\\\components\\\\layout\\\\ProtectedRoute.js\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { Navigate, Outlet } from 'react-router-dom';\nimport { useAuth } from '../../context/AuthContext'; // Access the Auth state\n\n/*\r\n * A wrapper component that checks user authentication and authorization (role).\r\n * It uses the 'Outlet' component from React Router to render child routes.\r\n  @param {string[]} allowedRoles - An array of roles permitted to access this route (e.g., ['user', 'admin']).\r\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  allowedRoles\n}) => {\n  _s();\n  // Pull authentication state from the AuthContext\n  const {\n    isAuthenticated,\n    role,\n    isLoading\n  } = useAuth();\n\n  // 1. Handle Loading State\n  // If the app is still checking the token from local storage, wait.\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading user session...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 12\n    }, this);\n  }\n\n  // 2. Check Authentication\n  if (!isAuthenticated) {\n    // User is not logged in: Redirect them to the login page.\n    // 'replace' ensures the login page replaces the current entry in the history stack.\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 12\n    }, this);\n  }\n\n  // 3. Check Authorization (Role)\n  // Check if the user's current role is included in the list of allowedRoles for this route.\n  if (allowedRoles && !allowedRoles.includes(role)) {\n    // Logged in, but role is not authorized (e.g., user tries to access /admin):\n    // Redirect to a specific unauthorized page or the user's default dashboard.\n    const defaultRedirect = role === 'user' ? '/posts' : '/admin';\n\n    // Redirect to the appropriate home page for their current role\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: defaultRedirect,\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 12\n    }, this);\n  }\n\n  // 4. Authorized: Render the nested route component\n  // 'Outlet' renders the child component defined in App.js (e.g., <AdminDashboard />)\n  return /*#__PURE__*/_jsxDEV(Outlet, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 41,\n    columnNumber: 10\n  }, this);\n};\n_s(ProtectedRoute, \"wmBZwuH1qMDqUXpAkMXks9a8PaE=\", false, function () {\n  return [useAuth];\n});\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","Navigate","Outlet","useAuth","jsxDEV","_jsxDEV","ProtectedRoute","allowedRoles","_s","isAuthenticated","role","isLoading","children","fileName","_jsxFileName","lineNumber","columnNumber","to","replace","includes","defaultRedirect","_c","$RefreshReg$"],"sources":["C:/Users/User/Documents/lostnfound_fullstack/frontend/src/components/layout/ProtectedRoute.js"],"sourcesContent":["import React from 'react';\r\nimport { Navigate, Outlet } from 'react-router-dom';\r\nimport { useAuth } from '../../context/AuthContext'; // Access the Auth state\r\n\r\n/*\r\n * A wrapper component that checks user authentication and authorization (role).\r\n * It uses the 'Outlet' component from React Router to render child routes.\r\n  @param {string[]} allowedRoles - An array of roles permitted to access this route (e.g., ['user', 'admin']).\r\n */\r\n\r\nconst ProtectedRoute = ({ allowedRoles }) => {\r\n  // Pull authentication state from the AuthContext\r\n  const { isAuthenticated, role, isLoading } = useAuth();\r\n  \r\n  // 1. Handle Loading State\r\n  // If the app is still checking the token from local storage, wait.\r\n  if (isLoading) {\r\n    return <div>Loading user session...</div>; \r\n  }\r\n\r\n  // 2. Check Authentication\r\n  if (!isAuthenticated) {\r\n    // User is not logged in: Redirect them to the login page.\r\n    // 'replace' ensures the login page replaces the current entry in the history stack.\r\n    return <Navigate to=\"/login\" replace />;\r\n  }\r\n\r\n  // 3. Check Authorization (Role)\r\n  // Check if the user's current role is included in the list of allowedRoles for this route.\r\n  if (allowedRoles && !allowedRoles.includes(role)) {\r\n    // Logged in, but role is not authorized (e.g., user tries to access /admin):\r\n    // Redirect to a specific unauthorized page or the user's default dashboard.\r\n    const defaultRedirect = role === 'user' ? '/posts' : '/admin';\r\n    \r\n    // Redirect to the appropriate home page for their current role\r\n    return <Navigate to={defaultRedirect} replace />;\r\n  }\r\n\r\n  // 4. Authorized: Render the nested route component\r\n  // 'Outlet' renders the child component defined in App.js (e.g., <AdminDashboard />)\r\n  return <Outlet />;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,EAAEC,MAAM,QAAQ,kBAAkB;AACnD,SAASC,OAAO,QAAQ,2BAA2B,CAAC,CAAC;;AAErD;AACA;AACA;AACA;AACA;AAJA,SAAAC,MAAA,IAAAC,OAAA;AAMA,MAAMC,cAAc,GAAGA,CAAC;EAAEC;AAAa,CAAC,KAAK;EAAAC,EAAA;EAC3C;EACA,MAAM;IAAEC,eAAe;IAAEC,IAAI;IAAEC;EAAU,CAAC,GAAGR,OAAO,CAAC,CAAC;;EAEtD;EACA;EACA,IAAIQ,SAAS,EAAE;IACb,oBAAON,OAAA;MAAAO,QAAA,EAAK;IAAuB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EAC3C;;EAEA;EACA,IAAI,CAACP,eAAe,EAAE;IACpB;IACA;IACA,oBAAOJ,OAAA,CAACJ,QAAQ;MAACgB,EAAE,EAAC,QAAQ;MAACC,OAAO;IAAA;MAAAL,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EACzC;;EAEA;EACA;EACA,IAAIT,YAAY,IAAI,CAACA,YAAY,CAACY,QAAQ,CAACT,IAAI,CAAC,EAAE;IAChD;IACA;IACA,MAAMU,eAAe,GAAGV,IAAI,KAAK,MAAM,GAAG,QAAQ,GAAG,QAAQ;;IAE7D;IACA,oBAAOL,OAAA,CAACJ,QAAQ;MAACgB,EAAE,EAAEG,eAAgB;MAACF,OAAO;IAAA;MAAAL,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAClD;;EAEA;EACA;EACA,oBAAOX,OAAA,CAACH,MAAM;IAAAW,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;AACnB,CAAC;AAACR,EAAA,CA/BIF,cAAc;EAAA,QAE2BH,OAAO;AAAA;AAAAkB,EAAA,GAFhDf,cAAc;AAiCpB,eAAeA,cAAc;AAAC,IAAAe,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}