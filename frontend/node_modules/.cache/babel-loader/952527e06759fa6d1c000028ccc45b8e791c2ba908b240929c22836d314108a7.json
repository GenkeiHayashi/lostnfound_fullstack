{"ast":null,"code":"import React from'react';import{Navigate,Outlet}from'react-router-dom';import{useAuth}from'../../context/AuthContext';// Access the Auth state\n/*\n * A wrapper component that checks user authentication and authorization (role).\n * It uses the 'Outlet' component from React Router to render child routes.\n  @param {string[]} allowedRoles - An array of roles permitted to access this route (e.g., ['user', 'admin']).\n */import{jsx as _jsx}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{allowedRoles}=_ref;// Pull authentication state from the AuthContext\nconst{isAuthenticated,role,isLoading}=useAuth();// 1. Handle Loading State\n// If the app is still checking the token from local storage, wait.\nif(isLoading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading user session...\"});}// 2. Check Authentication\nif(!isAuthenticated){// User is not logged in: Redirect them to the login page.\n// 'replace' ensures the login page replaces the current entry in the history stack.\nreturn/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});}// 3. Check Authorization (Role)\n// Check if the user's current role is included in the list of allowedRoles for this route.\nif(allowedRoles&&!allowedRoles.includes(role)){// Logged in, but role is not authorized (e.g., user tries to access /admin):\n// Redirect to a specific unauthorized page or the user's default dashboard.\nconst defaultRedirect=role==='user'?'/posts':'/admin';// Redirect to the appropriate home page for their current role\nreturn/*#__PURE__*/_jsx(Navigate,{to:defaultRedirect,replace:true});}// 4. Authorized: Render the nested route component\n// 'Outlet' renders the child component defined in App.js (e.g., <AdminDashboard />)\nreturn/*#__PURE__*/_jsx(Outlet,{});};export default ProtectedRoute;","map":{"version":3,"names":["React","Navigate","Outlet","useAuth","jsx","_jsx","ProtectedRoute","_ref","allowedRoles","isAuthenticated","role","isLoading","children","to","replace","includes","defaultRedirect"],"sources":["C:/Users/User/Documents/lostnfound_fullstack/frontend/src/components/layout/ProtectedRoute.js"],"sourcesContent":["import React from 'react';\nimport { Navigate, Outlet } from 'react-router-dom';\nimport { useAuth } from '../../context/AuthContext'; // Access the Auth state\n\n/*\n * A wrapper component that checks user authentication and authorization (role).\n * It uses the 'Outlet' component from React Router to render child routes.\n  @param {string[]} allowedRoles - An array of roles permitted to access this route (e.g., ['user', 'admin']).\n */\n\nconst ProtectedRoute = ({ allowedRoles }) => {\n  // Pull authentication state from the AuthContext\n  const { isAuthenticated, role, isLoading } = useAuth();\n  \n  // 1. Handle Loading State\n  // If the app is still checking the token from local storage, wait.\n  if (isLoading) {\n    return <div>Loading user session...</div>; \n  }\n\n  // 2. Check Authentication\n  if (!isAuthenticated) {\n    // User is not logged in: Redirect them to the login page.\n    // 'replace' ensures the login page replaces the current entry in the history stack.\n    return <Navigate to=\"/login\" replace />;\n  }\n\n  // 3. Check Authorization (Role)\n  // Check if the user's current role is included in the list of allowedRoles for this route.\n  if (allowedRoles && !allowedRoles.includes(role)) {\n    // Logged in, but role is not authorized (e.g., user tries to access /admin):\n    // Redirect to a specific unauthorized page or the user's default dashboard.\n    const defaultRedirect = role === 'user' ? '/posts' : '/admin';\n    \n    // Redirect to the appropriate home page for their current role\n    return <Navigate to={defaultRedirect} replace />;\n  }\n\n  // 4. Authorized: Render the nested route component\n  // 'Outlet' renders the child component defined in App.js (e.g., <AdminDashboard />)\n  return <Outlet />;\n};\n\nexport default ProtectedRoute;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,QAAQ,CAAEC,MAAM,KAAQ,kBAAkB,CACnD,OAASC,OAAO,KAAQ,2BAA2B,CAAE;AAErD;AACA;AACA;AACA;AACA,GAJA,OAAAC,GAAA,IAAAC,IAAA,yBAMA,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAsB,IAArB,CAAEC,YAAa,CAAC,CAAAD,IAAA,CACtC;AACA,KAAM,CAAEE,eAAe,CAAEC,IAAI,CAAEC,SAAU,CAAC,CAAGR,OAAO,CAAC,CAAC,CAEtD;AACA;AACA,GAAIQ,SAAS,CAAE,CACb,mBAAON,IAAA,QAAAO,QAAA,CAAK,yBAAuB,CAAK,CAAC,CAC3C,CAEA;AACA,GAAI,CAACH,eAAe,CAAE,CACpB;AACA;AACA,mBAAOJ,IAAA,CAACJ,QAAQ,EAACY,EAAE,CAAC,QAAQ,CAACC,OAAO,MAAE,CAAC,CACzC,CAEA;AACA;AACA,GAAIN,YAAY,EAAI,CAACA,YAAY,CAACO,QAAQ,CAACL,IAAI,CAAC,CAAE,CAChD;AACA;AACA,KAAM,CAAAM,eAAe,CAAGN,IAAI,GAAK,MAAM,CAAG,QAAQ,CAAG,QAAQ,CAE7D;AACA,mBAAOL,IAAA,CAACJ,QAAQ,EAACY,EAAE,CAAEG,eAAgB,CAACF,OAAO,MAAE,CAAC,CAClD,CAEA;AACA;AACA,mBAAOT,IAAA,CAACH,MAAM,GAAE,CAAC,CACnB,CAAC,CAED,cAAe,CAAAI,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}